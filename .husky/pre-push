#!/usr/bin/env sh
. "$(dirname "$0")/_/husky.sh" 2>/dev/null || true

# Pre-push verification: strict env doctor + tests
if command -v pnpm >/dev/null 2>&1; then
  echo "⏳ Running env doctor (strict) + tests before push..."
  pnpm run env:doc && pnpm test || {
    echo "✖ Pre-push checks failed. Fix errors or run 'pnpm run env:docto' locally to diagnose."
    exit 1
  }
else
  echo "ℹ️  pnpm not found; skipping pre-push checks."
fi
